# EXPECT-TYPECHECK
# EXPECT-EVALUATE

# This example tests rank-2 polymorphism in foralls capturing the sematics of
# the following pseudo-code:
#
# let f g x = g x in
# f ~ (forall beta. (forall innerBeta. innerBeta ~> {}) ~> beta ~> {})

f = fun g -> {
  returnF = fun x -> {
      returnG = g x
  }
};

return = f ~
  forall beta. fun forall innerBeta. fun innerBeta ~> { {} } ~>
    { fun beta ~> { {} } } ?
  fMatch -> {
    returnFMatch = {}
  } : fAntimatch -> {
    bogusFunctionFAntimatch = {};
    parameterForBogusFunctionFAntimatch = {};
    returnFAntimatch = bogusFunctionFAntimatch parameterForBogusFunctionFAntimatch
  }

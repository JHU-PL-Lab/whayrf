Name: Whayrf
Version: 0.1
Synopsis: Programming language with function pattern matching.
Authors: JHU PL Lab <pl.cs@jhu.edu>
License: BSD-4-clause

Description: The implementation of the language described in the "What is Your Function?" paper.
Homepage: http://www.big-bang-lang.org/

OASISFormat: 0.4
BuildTools: ocamlbuild
Plugins: META (0.4), DevFiles (0.4)
AlphaFeatures: ocamlbuild_more_args
XOCamlbuildExtraArgs: -use-menhir -use-ocamlfind

Library "whayrf-utils"
  Path: src/whayrf-utils
  Modules:
    Whayrf_ast_uid,
    Whayrf_logger,
    Whayrf_parser_support,
    Whayrf_source_origin,
    Whayrf_string_utils,
    Whayrf_utils
  BuildDepends:
    batteries

Library "whayrf-ast"
  Path: src/whayrf-ast
  Modules:
    Whayrf_ast,
    Whayrf_ast_pretty,
    Whayrf_ast_wellformedness
  BuildDepends:
    batteries,
    whayrf-utils

Library "whayrf-parser"
  Path: src/whayrf-parser
  Modules:
    Whayrf_generated_lexer,
    Whayrf_generated_parser,
    Whayrf_parser
  BuildDepends:
    batteries,
    whayrf-ast,
    whayrf-utils
  BuildTools+:
    ocamllex,
    menhir

Library "whayrf-interpreter"
  Path: src/whayrf-interpreter
  Modules:
    Whayrf_interpreter
  BuildDepends:
    batteries,
    whayrf-ast,
    whayrf-utils

Library "whayrf-typechecker"
  Path: src/whayrf-typechecker
  Modules:
    Whayrf_initial_alignment,
    Whayrf_typechecker,
    Whayrf_types,
    Whayrf_types_pretty
  BuildDepends:
    batteries,
    whayrf-ast,
    whayrf-utils

# Library "whayrf-nested-ast"
#   Path: src/whayrf-nested-ast
#   Modules:
#     Whayrf_nested_ast
#   BuildDepends:
#     batteries,
#     whayrf-ast,
#     whayrf-utils

# Library "whayrf-nested-parser"
#   Path: src/whayrf-nested-parser
#   Modules:
#     Whayrf_nested_generated_lexer,
#     Whayrf_nested_generated_parser,
#     Whayrf_nested_parser
#   BuildDepends:
#     batteries,
#     whayrf-nested-ast,
#     whayrf-utils
#   BuildTools+:
#     ocamllex,
#     menhir
    
# Library "whayrf-a-translator"
#   Path: src/whayrf-a-translator
#   Modules:
#     Whayrf_a_translator
#   BuildDepends:
#     batteries,
#     whayrf-ast,
#     whayrf-nested-ast,
#     whayrf-utils

Executable "whayrf-toploop"
  Path: src/whayrf-toploop
  MainIs: whayrf_toploop.ml
  BuildDepends:
    whayrf-ast,
    whayrf-interpreter,
    whayrf-parser,
    whayrf-typechecker,
    batteries

# Executable "whayrf-nested-toploop"
#   Path: src/whayrf-nested-toploop
#   MainIs: whayrf_nested_toploop.ml
#   BuildDepends:
#     whayrf-a-translator,
#     whayrf-ast,
#     whayrf-nested-ast,
#     whayrf-interpreter,
#     whayrf-nested-parser,
#     batteries

Executable "test-whayrf"
  Path: test/
  MainIs: test_whayrf.ml
  BuildDepends:
    whayrf-interpreter,
    whayrf-parser,
    whayrf-typechecker,
    whayrf-utils,
    oUnit,
    batteries

Test test_whayrf
  Command: $test_whayrf

